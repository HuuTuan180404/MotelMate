<div class="tenant-detail-container">
  <mat-card class="tenant-card" *ngIf="_tenantDetail">
    <!-- Header with avatar and basic info -->
    <mat-card-header class="tenant-header">
      <div mat-card-avatar class="tenant-avatar">
        <img
          aria-label="avatar"
          [src]="_tenantDetail?.urlAvatar"
          [alt]="_tenantDetail?.fullName"
          class="avatar-image"
        />
      </div>
      <mat-card-title>{{ _tenantDetail?.fullName }}</mat-card-title>
      <mat-card-subtitle>Tenant</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content class="tenant-content">
      <!-- Personal Information -->
      <div class="info-section">
        <h3 class="section-title">
          <mat-icon>person</mat-icon>
          Personal Information
        </h3>

        <div class="info-grid">
          <div class="info-item">
            <mat-icon class="info-icon">badge</mat-icon>
            <div class="info-details">
              <span class="info-label">ID:</span>
              <span class="info-value">{{ _tenantDetail?.cccd }}</span>
            </div>
          </div>

          <div class="info-item">
            <mat-icon class="info-icon">person_outline</mat-icon>
            <div class="info-details">
              <span class="info-label">Full Name:</span>
              <span class="info-value">{{ _tenantDetail?.fullName }}</span>
            </div>
          </div>

          <div class="info-item">
            <mat-icon class="info-icon">phone</mat-icon>
            <div class="info-details">
              <span class="info-label">Phone Number:</span>
              <span class="info-value">0364626275</span>
            </div>
          </div>

          <div class="info-item">
            <mat-icon class="info-icon">cake</mat-icon>
            <div class="info-details">
              <span class="info-label">Date of Birth:</span>
              <span class="info-value">
                {{ _tenantDetail?.bdate | date: 'dd/MM/yyyy' }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Rental History -->
      <div class="history-section">
        <h3 class="section-title">
          <mat-icon>history</mat-icon>
          Rental History [ {{ _tenantDetail?.contractDetails?.length }}
          Contract(s) ]
        </h3>

        <div class="history-list">
          <mat-card
            *ngFor="let history of _tenantDetail?.contractDetails"
            class="history-card"
            [class.active-contract]="history.endDate === null"
          >
            <mat-card-header class="history-header">
              <div class="contract-info">
                <mat-card-title class="contract-code">
                  {{ history.contractID }}
                </mat-card-title>
              </div>

              <div class="status-badge">
                <mat-chip
                  [color]="history.endDate === null ? 'accent':'primary'"
                  selected
                >
                  <mat-icon>
                    {{ history.endDate === null ? 'home' : 'check_circle' }}
                  </mat-icon>
                  {{ history.endDate === null ? 'Currently Renting' :
                  'Terminated'}}
                </mat-chip>
              </div>
            </mat-card-header>

            <mat-card-content class="history-content">
              <div class="date-duration-row">
                <div class="date-item">
                  <mat-icon class="date-icon checkin">login</mat-icon>
                  <div class="date-details">
                    <span class="date-label">Move-in Date:</span>
                    <span class="date-value">
                      {{ history.startDate | date }}
                    </span>
                  </div>
                </div>
                <div class="date-item">
                  <mat-icon class="date-icon checkout">logout</mat-icon>
                  <div class="date-details">
                    <span class="date-label">Move-out Date:</span>
                    <span class="date-value">
                      {{ history.endDate === null ? 'Currently Staying' :
                      (history.endDate | date:'dd/MM/yyyy') }}
                    </span>
                  </div>
                </div>
                <div class="duration-rent">
                  <div class="duration-info">
                    <mat-icon>schedule</mat-icon>
                    <div class="duration-details">
                      <span class="duration-label">Duration of Stay:</span>
                      <span class="duration-value">
                        {{ calculateDuration(history.startDate, history.endDate)
                        }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Empty state -->
          <div
            *ngIf="_tenantDetail?.contractDetails?.length === 0"
            class="empty-history"
          >
            <mat-icon class="empty-icon">history_toggle_off</mat-icon>
            <h4>No Rental History</h4>
            <p>This tenant does not have any rental contracts yet.</p>
          </div>
        </div>
      </div>
    </mat-card-content>

    <div class="card-actions">
      <button mat-raised-button (click)="onClickDone()">
        <mat-icon>done</mat-icon>
        Done
      </button>
    </div>
  </mat-card>
</div>
