<div class="main">
  <!-- Header with Title and Search -->
  <div class="header-container">
    <h2 class="page-title">BUILDING MANAGEMENT</h2>
    <div class="search-container">
      <mat-form-field appearance="outline" class="search-field">
        <input
          matInput
          [(ngModel)]="searchTerm"
          (input)="applyFilters()"
          placeholder="Search"
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
  </div>

  <!-- Table Container -->
  <div class="table-container">
    <!-- Filters Row -->
    <div class="filters-container">
      <div></div>
      <div></div>
      <div></div>
      <mat-form-field appearance="outline" class="filter-field">
        <mat-select
          [(ngModel)]="filters.building"
          (selectionChange)="applyFilters()"
          placeholder="Building"
        >
          <mat-option value="">Building</mat-option>
          <mat-option *ngFor="let b of buildings" [value]="b"
            >{{ b }}</mat-option
          >
        </mat-select>
        <mat-icon matSuffix>apartment</mat-icon>
      </mat-form-field>
    </div>

    <table
      mat-table
      [dataSource]="filteredcontracts.slice(pageIndex * pageSize, (pageIndex + 1) * pageSize)"
      class="contracts-table"
    >
      <ng-container matColumnDef="code">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          sortActionDescription="Sort by name"
        >
          Room
        </th>
        <td mat-cell *matCellDef="let inv">{{inv.code}}</td>
      </ng-container>

      <ng-container matColumnDef="building">
        <th mat-header-cell *matHeaderCellDef>Building</th>
        <td mat-cell *matCellDef="let inv">{{inv.building}}</td>
      </ng-container>

      <ng-container matColumnDef="address">
        <th mat-header-cell *matHeaderCellDef>Address</th>
        <td mat-cell *matCellDef="let inv">{{inv.address}}</td>
      </ng-container>

      <ng-container matColumnDef="tenants">
        <th mat-header-cell *matHeaderCellDef>Tenants</th>
        <td mat-cell *matCellDef="let inv">{{inv.tenants}}</td>
      </ng-container>

      <ng-container matColumnDef="rooms">
        <th mat-header-cell *matHeaderCellDef>Rooms</th>
        <td mat-cell *matCellDef="let inv">{{inv.rooms}}</td>
      </ng-container>

      <ng-container matColumnDef="available">
        <th mat-header-cell *matHeaderCellDef>Available</th>
        <td mat-cell *matCellDef="let inv">{{inv.available}}</td>
      </ng-container>

      <ng-container matColumnDef="occupied">
        <th mat-header-cell *matHeaderCellDef>Occupied</th>
        <td mat-cell *matCellDef="let inv">{{inv.occupied | number}}</td>
      </ng-container>

      <ng-container matColumnDef="maintenance">
        <th mat-header-cell *matHeaderCellDef>Maintenance</th>
        <td mat-cell *matCellDef="let inv">{{ inv.maintenance }}</td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['code','building', 'address', 'tenants','rooms', 'available', 'occupied', 'maintenance']"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['code','building', 'address', 'tenants','rooms', 'available', 'occupied', 'maintenance'];"
      ></tr>
    </table>
    <!-- Custom Paginator -->
    <div class="custom-paginator">
      <!-- Left side: Showing info -->
      <div class="paginator-info">
        <span>Showing up to </span>
        <select
          [(ngModel)]="pageSize"
          (change)="onPageSizeChange()"
          class="page-size-select"
          aria-label="page size select"
        >
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
        </select>
        <span> of {{ filteredcontracts.length }} results</span>
      </div>

      <!-- Right side: Page numbers -->
      <div class="pagination-numbers">
        <!-- Previous button -->
        <button
          class="page-btn prev-btn"
          [disabled]="pageIndex === 0"
          (click)="goToPage(pageIndex - 1)"
        >
          ‹
        </button>

        <!-- Page numbers -->
        <button
          *ngFor="let page of getPageNumbers()"
          class="page-btn"
          [class.active]="page === pageIndex + 1"
          (click)="goToPage(page - 1)"
        >
          {{ page }}
        </button>

        <!-- Next button -->
        <button
          class="page-btn next-btn"
          [disabled]="pageIndex >= getTotalPages() - 1"
          (click)="goToPage(pageIndex + 1)"
        >
          ›
        </button>
      </div>
    </div>
  </div>
</div>
